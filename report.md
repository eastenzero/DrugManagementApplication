# 药品管理系统设计与实现

## 摘要

随着医院及药店业务的不断发展，药品种类和库存规模快速增长，传统依靠人工或 Excel 表格管理药品的方式已难以满足精细化管理的需要。为提高药品信息维护效率、规范入库出库流程并减少差错，本课题设计并实现了一个基于 Spring Boot 与 MySQL 的药品管理系统。

系统主要功能包括：用户登录与注册、药品分类管理、药品信息管理、药品入库管理、药品出库管理以及库存联动。系统采用 B/S 架构，后端基于 Spring Boot + Spring Data JPA 实现业务逻辑和数据持久化，前端采用 Thymeleaf 模板引擎实现页面展示，数据库使用 MySQL 存储药品及库存数据。

实践表明，该系统能够较好地满足日常药品管理需求，实现了药品信息的集中存储、入库出库过程的规范记录以及库存数量的自动增减，为后续功能扩展和性能优化奠定了基础。

**关键词：** 药品管理；Spring Boot；MySQL；Spring Data JPA；Thymeleaf

---

## 第1章 绪论

### 1.1 课题背景与意义

信息技术的快速发展推动了医疗卫生行业的信息化建设。药品管理作为医院与药店管理中的重要组成部分，直接关系到患者用药安全和经营效率。传统药品管理方式多依靠手工登记或电子表格进行记录，存在以下问题：

- 数据分散，难以统一维护；
- 入库出库操作依赖人工计算，易发生库存差错；
- 缺乏权限控制，操作记录难以追踪；
- 无法方便地进行查询统计和历史记录追溯。

因此，设计并实现一个结构清晰、功能完备且易于扩展的药品管理系统具有重要的现实意义。本项目以 Java EE 技术为基础，选择 Spring Boot + MySQL 技术栈，实现药品分类管理、药品信息管理、入库出库与库存联动等功能，为课程学习与实践提供一个完整的案例。

### 1.2 研究内容与目标

本课题主要研究内容包括：

- 分析药品管理业务需求，明确系统功能与非功能需求；
- 设计系统整体架构与功能模块划分；
- 设计符合第三范式要求的数据库表结构；
- 基于 Spring Boot 实现后端业务逻辑与数据访问；
- 基于 Thymeleaf 实现前端界面及基本交互；
- 完成系统测试，验证系统的正确性与稳定性。

项目目标是实现一个包含登录/注册、药品分类、药品信息、入库出库及库存管理等功能的 Web 应用，并形成完整的文档说明，满足课程项目作业要求。

### 1.3 本文结构安排

- 第1章：绪论  
- 第2章：系统需求分析  
- 第3章：关键技术介绍  
- 第4章：系统总体设计  
- 第5章：数据库设计  
- 第6章：系统实现  
- 第7章：系统测试  
- 第8章：总结与展望  

---

## 第2章 系统需求分析

### 2.1 功能需求分析

根据课程要求及实际业务情况，本系统主要功能需求如下：

- **用户模块**
  - 用户注册：新用户注册账号，默认为管理员角色（便于课程演示）。
  - 用户登录：输入用户名和密码进行身份验证，仅启用状态用户可登录。
  - 注销退出：安全退出系统，清除会话信息。

- **药品分类管理模块**
  - 分类列表：查看已存在的药品分类。
  - 新增分类：添加新的药品分类信息。
  - 编辑分类：修改分类名称和描述信息。
  - 删除分类：删除未被药品引用的分类；被引用时限制删除。

- **药品信息管理模块**
  - 药品列表：查看所有药品信息，支持按名称模糊查询。
  - 新增药品：录入药品名称、分类、规格、单位、单价、库存、生产厂家、生产日期、有效期、状态等信息。
  - 编辑药品：修改现有药品数据。
  - 删除药品：删除不再使用的药品信息或模拟下架。

- **药品入库管理模块**
  - 入库记录列表：查看所有入库记录。
  - 新增入库记录：选择药品、填写数量、单价、供应商、批号、备注等。
  - 库存联动：入库成功后自动增加对应药品的库存数量。

- **药品出库管理模块**
  - 出库记录列表：查看所有出库记录。
  - 新增出库记录：选择药品、填写数量、出库原因、备注等。
  - 库存联动：出库成功后自动减少药品库存，并进行库存不足校验。

### 2.2 用户角色与使用场景

为简化课程项目，本系统主要设置两类角色（当前实现中均按管理员处理）：

- 管理员用户：
  - 维护药品分类；
  - 维护药品基础信息；
  - 记录入库出库；
  - 查看库存信息。

在后续扩展中可以进一步区分普通操作员与系统管理员，如限制某些敏感操作仅由管理员执行。

### 2.3 非功能需求分析

- **性能需求**：在单机环境下支持日常数量级的数据查询与简单统计，在少量并发访问下保持良好响应速度。
- **安全性需求**：通过登录与会话管理保证仅登录用户可以访问后台功能。
- **可维护性**：采用典型的分层架构与标准框架，降低代码耦合度，便于维护和扩展。
- **易用性**：界面布局简洁明了，操作流程直观、易于上手。

---

## 第3章 关键技术介绍

### 3.1 Spring Boot 框架

Spring Boot 是基于 Spring 的快速开发框架，通过“约定优于配置”简化了项目配置与部署。本系统使用 Spring Boot 2.7.18 作为后端核心框架，实现以下功能：

- 快速创建 Web 应用与内嵌 Tomcat；
- 自动装配常用组件（如 Spring MVC、Spring Data JPA 等）；
- 通过配置文件 `application.properties` 管理数据库连接、端口等信息。

### 3.2 Spring MVC

Spring MVC 是 Spring 提供的 Web MVC 框架。本系统使用 Spring MVC 实现控制层逻辑：

- 使用 `@Controller`、`@RequestMapping`、`@GetMapping`、`@PostMapping` 等注解完成请求映射；
- 通过 `Model` 向视图传递数据；
- 使用 `HttpSession` 保存当前登录用户信息，实现简单会话管理。

### 3.3 Spring Data JPA

Spring Data JPA 封装了 JPA 常用操作，简化了数据访问层的开发。本系统中：

- 使用 `JpaRepository` 接口快速生成 CRUD 方法；
- 使用方法名约定（如 `findByNameContaining`）实现简单查询；
- 通过实体类与注解映射数据库表结构。

### 3.4 Thymeleaf 模板引擎

Thymeleaf 是一种现代化服务器端模板引擎，可与 Spring MVC 无缝集成。本系统使用 Thymeleaf 实现：

- 动态渲染 HTML 页面；
- 通过 `th:each`、`th:text`、`th:href` 等属性绑定数据与链接；
- 实现简单表单提交与数据展示。

### 3.5 MySQL 数据库

MySQL 是广泛使用的开源关系型数据库。本系统使用 MySQL 存储用户、药品分类、药品信息以及入库出库记录等数据。通过 JDBC 与 MySQL 官方驱动 `mysql-connector-j 8.0.33` 连接数据库，使用 InnoDB 引擎提供事务与外键支持。

---

## 第4章 系统总体设计

### 4.1 系统架构设计

系统采用典型的三层架构：

- **表示层（Controller + Thymeleaf）**
  - 接收并处理来自浏览器的 HTTP 请求；
  - 进行简单的参数校验；
  - 组织业务结果，传递给视图层渲染页面。

- **业务逻辑层（Service / Controller 简化实现）**
  - 根据业务需求调用数据访问层；
  - 实现入库出库时的库存增减逻辑；
  - 实现简单的权限控制（登录校验）。

- **数据访问层（Repository）**
  - 基于 Spring Data JPA 实现实体的增删改查；
  - 负责与 MySQL 数据库交互。

### 4.2 功能模块结构

系统功能模块结构可概括如下：

- 用户与权限模块
  - 用户注册
  - 用户登录
  - 退出登录
- 药品分类模块
  - 分类维护（增删改查）
- 药品信息模块
  - 药品信息维护（增删改查）
  - 药品模糊查询
- 入库管理模块
  - 入库记录维护
  - 库存增加
- 出库管理模块
  - 出库记录维护
  - 库存减少与不足校验

（在 Word 文档中可配合绘制功能模块图）

### 4.3 系统运行环境

- 操作系统：Windows
- 开发工具：IntelliJ IDEA
- JDK 版本：JDK 8+
- 构建工具：Maven
- 后端框架：Spring Boot 2.7.18
- 视图技术：Thymeleaf
- 数据库：MySQL（如 8.0）
- 浏览器：Chrome / Edge 等现代浏览器

---

## 第5章 数据库设计

### 5.1 概念设计

根据需求分析，系统中主要实体包括：

- 用户（User）
- 药品分类（DrugCategory）
- 药品信息（DrugInfo）
- 入库记录（StockIn）
- 出库记录（StockOut）

实体之间的关系主要包括：

- 一个药品分类对应多个药品（1:N）；
- 一个药品对应多条入库记录和多条出库记录（1:N）；
- 一个用户可作为多个入库/出库记录的操作人（1:N）。

（在 Word 文档中可绘制 E-R 图进行展示）

### 5.2 逻辑结构设计（表结构）

#### 5.2.1 用户表 `sys_user`

| 字段名      | 类型         | 约束               | 说明               |
|-------------|--------------|--------------------|--------------------|
| id          | BIGINT       | PK, AUTO_INCREMENT | 用户主键           |
| username    | VARCHAR(50)  | NOT NULL, UNIQUE   | 登录用户名         |
| password    | VARCHAR(100) | NOT NULL           | 登录密码           |
| role        | VARCHAR(20)  | NOT NULL           | 角色（admin 等）  |
| status      | TINYINT      | NOT NULL           | 状态：1 启用/0 禁用 |
| create_time | DATETIME     | NOT NULL           | 创建时间           |

#### 5.2.2 药品分类表 `drug_category`

| 字段名      | 类型         | 约束               | 说明     |
|-------------|--------------|--------------------|----------|
| id          | BIGINT       | PK, AUTO_INCREMENT | 分类主键 |
| name        | VARCHAR(50)  | NOT NULL           | 分类名称 |
| description | VARCHAR(200) |                    | 分类描述 |
| create_time | DATETIME     | NOT NULL           | 创建时间 |

#### 5.2.3 药品信息表 `drug_info`

| 字段名          | 类型           | 约束                          | 说明               |
|-----------------|----------------|-------------------------------|--------------------|
| id              | BIGINT         | PK, AUTO_INCREMENT            | 药品主键           |
| name            | VARCHAR(100)   | NOT NULL                      | 药品名称           |
| category_id     | BIGINT         | NOT NULL, FK→drug_category.id | 所属分类           |
| specification   | VARCHAR(100)   |                               | 规格               |
| unit            | VARCHAR(20)    |                               | 计量单位           |
| price           | DECIMAL(10,2)  |                               | 单价               |
| stock           | INT            | NOT NULL, DEFAULT 0           | 当前库存           |
| manufacturer    | VARCHAR(100)   |                               | 生产厂家           |
| production_date | DATE           |                               | 生产日期           |
| expire_date     | DATE           |                               | 有效期至           |
| status          | TINYINT        | NOT NULL, DEFAULT 1           | 状态：1 上架/0 下架 |
| create_time     | DATETIME       | NOT NULL                      | 创建时间           |

#### 5.2.4 药品入库表 `stock_in`

| 字段名     | 类型           | 约束                      | 说明         |
|------------|----------------|---------------------------|--------------|
| id         | BIGINT         | PK, AUTO_INCREMENT        | 入库记录主键 |
| drug_id    | BIGINT         | NOT NULL, FK→drug_info.id | 入库药品     |
| quantity   | INT            | NOT NULL                  | 入库数量     |
| price      | DECIMAL(10,2)  |                           | 入库单价     |
| supplier   | VARCHAR(100)   |                           | 供应商       |
| batch_no   | VARCHAR(50)    |                           | 批号         |
| in_time    | DATETIME       | NOT NULL                  | 入库时间     |
| operator_id| BIGINT         | FK→sys_user.id            | 操作人       |
| remark     | VARCHAR(200)   |                           | 备注         |

#### 5.2.5 药品出库表 `stock_out`

| 字段名     | 类型           | 约束                      | 说明         |
|------------|----------------|---------------------------|--------------|
| id         | BIGINT         | PK, AUTO_INCREMENT        | 出库记录主键 |
| drug_id    | BIGINT         | NOT NULL, FK→drug_info.id | 出库药品     |
| quantity   | INT            | NOT NULL                  | 出库数量     |
| reason     | VARCHAR(100)   |                           | 出库原因     |
| out_time   | DATETIME       | NOT NULL                  | 出库时间     |
| operator_id| BIGINT         | FK→sys_user.id            | 操作人       |
| remark     | VARCHAR(200)   |                           | 备注         |

完整建表脚本已保存在项目的 `src/main/resources/db/schema.sql` 文件中。

---

## 第6章 系统实现

本章主要从用户模块、药品分类模块、药品信息模块、入库模块和出库模块五个方面介绍系统的主要实现过程。以下每小节中提到的截图，可在运行系统时使用浏览器或 IDEA 截图，并按顺序插入到 Word 文档中。

### 6.1 用户登录与注册模块

用户模块主要包括注册、登录、退出功能：

- 注册：访问 `/register` 页面，填入用户名和密码，系统检查用户名是否已存在，若不存在则创建新用户并提示注册成功。
- 登录：访问 `/login` 页面，输入用户名和密码，系统校验用户状态为启用后，将用户对象保存到 `HttpSession` 中。
- 退出：访问 `/logout`，清除会话信息并跳转到登录页面。

**截图建议：**

- 图6-1 用户注册页面截图  
- 图6-2 用户登录页面截图  
- 图6-3 后台主页页面截图  

### 6.2 药品分类管理模块

分类模块实现了对药品分类的增删改查功能：

- 分类列表页面 `/categories`：展示所有分类信息。
- 新增分类 `/categories/add`：填写分类名称和描述。
- 编辑分类 `/categories/edit/{id}`：修改已存在分类。
- 删除分类 `/categories/delete/{id}`：若分类已被药品引用，捕获异常并提示“删除失败，可能有药品正在使用该分类”。

**截图建议：**

- 图6-4 药品分类列表页面截图  
- 图6-5 新增/编辑药品分类页面截图  

### 6.3 药品信息管理模块

药品模块实现对药品基础信息的维护和查询：

- 药品列表 `/drugs`：展示所有药品信息，并支持按名称关键字模糊搜索。
- 新增药品 `/drugs/add`：录入名称、分类、规格、单位、单价、库存、生产厂家、生产日期、有效期、状态等信息。
- 编辑药品 `/drugs/edit/{id}`：对已有药品进行修改。
- 删除药品 `/drugs/delete/{id}`：删除不再使用的药品信息。

**截图建议：**

- 图6-6 药品信息列表页面截图  
- 图6-7 新增/编辑药品信息页面截图  

### 6.4 药品入库管理模块

入库模块用于记录药品的入库信息并自动增加库存：

- 入库记录列表 `/stock-in`：展示所有入库记录，包括药品名称、数量、单价、入库时间、操作人等。
- 新增入库 `/stock-in/add`：
  - 选择现有药品；
  - 填写入库数量、单价、供应商、批号、备注；
  - 入库成功后：
    - 在 `stock_in` 表中新增一条记录；
    - 同时将对应药品的 `stock` 字段增加相应数量。

**截图建议：**

- 图6-8 入库记录列表页面截图  
- 图6-9 新增入库记录页面截图  

### 6.5 药品出库管理模块

出库模块用于记录药品的出库信息并自动减少库存：

- 出库记录列表 `/stock-out`：展示药品出库记录，包括药品名称、数量、出库时间、原因、操作人等。
- 新增出库 `/stock-out/add`：
  - 选择现有药品；
  - 填写出库数量、出库原因和备注；
  - 系统首先读取当前库存数量，若出库数量大于库存，提示“库存不足，当前库存为 X”，并拒绝本次操作；
  - 若库存充足，则：
    - 在 `stock_out` 表中新增记录；
    - 将 `drug_info` 表中对应药品的 `stock` 字段减少相应数量。

**截图建议：**

- 图6-10 出库记录列表页面截图  
- 图6-11 新增出库记录页面截图  
- 图6-12 出库库存不足提示页面截图  

---

## 第7章 系统测试

### 7.1 测试环境

- 操作系统：Windows  
- JDK：JDK 8+  
- 数据库：MySQL 8.0  
- 浏览器：Chrome / Edge  
- 测试方式：黑盒测试为主，手工执行测试用例。

### 7.2 测试用例设计

选取部分典型测试用例如下：

**表7-1 登录模块测试用例**

| 用例编号 | 测试内容           | 输入                    | 期望结果                            | 测试结果 |
|----------|--------------------|-------------------------|-------------------------------------|----------|
| TC-01    | 正确用户名密码登录 | 正确用户名 + 正确密码   | 登录成功，跳转到后台主页            | 通过     |
| TC-02    | 错误密码登录       | 正确用户名 + 错误密码   | 提示“用户名或密码错误”             | 通过     |
| TC-03    | 禁用用户登录       | 禁用状态用户 + 正确密码 | 提示“用户名或密码错误，或账号被禁用” | 通过     |

**表7-2 药品入库出库测试用例**

| 用例编号 | 测试内容         | 前置条件           | 输入        | 期望结果                             | 测试结果 |
|----------|------------------|--------------------|-------------|--------------------------------------|----------|
| TC-04    | 正常入库         | 药品库存初始为 10  | 入库数量 5  | 库存变为 15，新增一条入库记录        | 通过     |
| TC-05    | 正常出库         | 药品库存初始为 15  | 出库数量 3  | 库存变为 12，新增一条出库记录        | 通过     |
| TC-06    | 出库数量大于库存 | 药品库存初始为 2   | 出库数量 5  | 提示“库存不足，当前库存为 2”，库存不变 | 通过     |

### 7.3 测试结果分析

通过对登录、药品分类、药品信息、入库出库及库存变更等关键功能的测试，系统在常规操作场景下能够满足预期行为：

- 用户认证逻辑正确，未登录用户无法访问后台管理功能；
- 药品分类与信息维护功能完整，增删改查操作正常；
- 入库出库记录能正确反映到药品库存字段中；
- 出库时的库存不足校验能够有效阻止非法操作。

整体测试结果表明，本系统功能实现基本正确，能够满足课程设计要求。

---

## 第8章 总结与展望

本课题基于 Spring Boot 与 MySQL 设计并实现了一个简易的药品管理系统，完成了用户登录注册、药品分类管理、药品信息管理以及入库出库和库存联动等主要功能。通过本项目实践，加深了对 Java Web 开发、Spring Boot 框架以及数据库设计的理解，提升了综合开发能力。

当然，系统仍有较多可以改进和扩展的空间，主要包括：

- 在密码存储方面，可以引入加密算法（如 BCrypt）提升安全性；
- 引入角色与权限控制框架，对不同角色进行更细粒度的权限管理；
- 增加分页、导出报表、统计分析等功能，提升系统实用性；
- 使用前后端分离架构和更美观的前端框架（如 Vue、Element UI）优化用户体验.

未来工作中，可在现有系统基础上继续扩展功能与优化性能，使之更加贴近真实业务需求.

---

### 参考文献

[1] Rod Johnson. *Expert One-on-One J2EE Development without EJB*. Wrox Press, 2004.  
[2] Craig Walls. *Spring in Action (5th Edition)*. Manning Publications, 2018.  
[3] MySQL 官方文档. https://dev.mysql.com/doc/  

## 附录A 前端实现与接口说明

### A.1 前端技术栈概述

在原有基于 Thymeleaf 的页面实现基础上，系统进一步采用了**前后端分离**的方式，构建了一个基于 Vue 3 的单页应用（SPA），以提升交互体验与界面美观度. 前端主要技术栈如下：

- **Vue 3 + Composition API**：作为核心前端框架，负责页面组件化和响应式渲染.
- **TypeScript**：为项目提供静态类型检查，减少运行时错误.
- **Vite**：作为现代化构建工具，提供极速的开发服务器与按需打包.
- **Element Plus**：基于 Vue 3 的组件库，用于构建登录表单、表格、弹窗、菜单等界面组件.
- **Pinia**：状态管理库，用于统一管理用户登录状态（如 token、用户名）.
- **Vue Router 4**：实现前端路由与菜单跳转，例如 `/login`、`/register`、`/dashboard` 等路径.
- **Axios**：封装 HTTP 请求，与后端 REST API 进行数据交互.

通过上述技术组合，前端实现了模块化开发、统一的界面风格与较好的可维护性.

### A.2 主要页面与交互效果

当前前端应用提供的主要页面包括：

- **登录 / 注册页面**：
  - 使用 Element Plus 表单组件与校验规则完成用户输入校验；
  - 登录成功后，通过 Pinia 将 `token` 与 `username` 保存在全局状态及 `localStorage` 中，实现刷新后仍保持登录状态.

- **仪表盘（Dashboard）页面**：
  - 通过 `getDrugs` 与 `getCategories` 接口统计药品总数、分类数量、库存预警数量以及库存总价值；
  - 以卡片形式展示关键指标，便于管理人员快速了解库存概况.

- **药品分类管理页面**：
  - 使用表格展示所有分类信息；
  - 通过弹出对话框完成新增、编辑操作；
  - 删除分类时，若后端返回“有药品正在使用该分类”，会通过消息提示给用户.

- **药品信息管理页面**：
  - 表格展示药品名称、分类、规格、单位、单价、库存、状态等信息；
  - 顶部提供关键字搜索条，支持按药品名称模糊查询；
  - 新增/编辑时，通过下拉框选择分类，并使用日期选择器录入生产日期和有效期；
  - 对库存较低的药品使用红色高亮和标签进行预警.

- **入库管理页面**：
  - 表格展示入库记录，包括药品名称、数量、单价、供应商、批号、入库时间、操作人等；
  - 新增入库时，从药品列表中选择药品，填写数量和价格等信息；
  - 入库成功后，前端自动刷新入库记录与药品列表，实现库存联动展示.

- **出库管理页面**：
  - 表格展示出库记录，包括药品名称、数量、出库原因、出库时间、操作人等；
  - 新增出库时，使用自定义校验规则检查出库数量是否超过当前库存，超出时在前端直接给出错误提示；
  - 出库成功后，同步刷新出库记录与药品库存列表.

- **库存总览页面**：
  - 汇总展示所有药品当前库存情况；
  - 提供按分类筛选功能，便于按类别查看库存；
  - 对低库存药品以行高亮和“库存不足”标签标记，形成直观的库存预警.

### A.3 REST API 交互与安全控制

前端通过统一的 `request.ts` 封装 Axios 实例，与后端 `/api/**` 路径的 REST 接口进行交互：

- **基础配置**：
  - `baseURL` 统一设置为 `http://localhost:8080/api`；
  - 请求拦截器自动在请求头中附加 `Authorization: Bearer <token>`，实现简单的会话传递.

- **典型接口示例**：
  - 用户认证：`POST /auth/login`、`POST /auth/register`；
  - 药品管理：`GET /drugs`（支持 `keyword` 查询）、`POST /drugs`、`PUT /drugs/{id}`、`DELETE /drugs/{id}`；
  - 分类管理：`GET /categories`、`POST /categories`、`PUT /categories/{id}`、`DELETE /categories/{id}`；
  - 入库管理：`GET /stock-in`、`POST /stock-in`；
  - 出库管理：`GET /stock-out`、`POST /stock-out`.

后端通过 Spring Boot 提供 JSON 格式的响应，并在全局配置了 CORS 规则，允许 `http://localhost:5174` 等前端开发地址访问 `/api/**` 接口，解决浏览器跨域访问问题.

### A.4 系统部署与运行步骤

为方便教师与同学快速搭建运行环境，本项目的推荐运行步骤如下：

1. **准备环境**：
   - 安装 JDK 8+；
   - 安装 MySQL 并导入项目提供的数据库脚本；
   - 安装 Node.js（建议 16+ 版本）.

2. **启动后端（Spring Boot）**：
   - 在 IDEA 中打开 `backend` 工程，配置好数据库连接；
   - 运行 `DrugManagementApplication` 主类，后台监听 `http://localhost:8080`；
   - 首次启动时，`DataInitializer` 会自动插入部分模拟分类、药品及入库出库记录，便于测试与演示.

3. **启动前端（Vue 3 应用）**：
   - 在命令行进入 `frontend` 目录；
   - 执行依赖安装命令：`npm install`；
   - 执行开发运行命令：`npm run dev`；
   - 根据终端提示访问前端地址（如 `http://localhost:5174`）.

4. **登录与体验系统功能**：
   - 使用浏览器访问前端地址，先进行用户注册或使用已有账号登录；
   - 依次体验仪表盘、药品分类、药品信息、入库、出库及库存总览等模块；
   - 可配合抓取浏览器控制台与接口请求，验证前后端数据交互是否正确.
